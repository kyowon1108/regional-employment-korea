# 데이터 전처리 재구성 계획

## 1. 목표
- **최종 칼럼**: 시도, 시군구, 면적, 연도, 반기, E9_체류자수, 제조업_종사자수, 서비스업_종사자수, 취업자, 고용률
- **연도 범위**: 2019년~2023년
- **반기**: 1, 2 (구분되지 않은 데이터는 2 반기로 처리)

## 2. 데이터 소스 분석

### 2.1 기본 지역 정보 (지역_면적_utf8.csv)
- **칼럼**: 시도, 시군구, 면적, 제조업비중, 서비스업비중
- **역할**: 시도-시군구 매핑의 기준이 되는 마스터 데이터
- **총 행 수**: 231개 지역

### 2.2 E9 체류자 데이터 (시군구별_E9_체류자(2014~2023).csv)
- **칼럼**: 시도(1), 시군구(2), 구분(1), 2014~2023년 데이터
- **문제점**: 인코딩 문제 (깨진 문자)
- **역할**: E9_체류자수 제공
- **총 행 수**: 840행

### 2.3 산업별 종사자 데이터 (지역별_산업별_종사자.csv)
- **칼럼**: 시도, 시군구, 구분, 연도별 반기별 데이터
- **역할**: 제조업_종사자수, 서비스업_종사자수 제공
- **총 행 수**: 15,215행

### 2.4 취업자 및 고용률 데이터 (시군구 연령별 취업자 및 고용률 (2021~2024반기).csv)
- **칼럼**: 시도시군구, 구분, 연도별 반기별 취업자수, 고용률
- **역할**: 취업자, 고용률 제공
- **총 행 수**: 231행

### 2.5 경제활동인구 데이터 (시군구별_경제활동인구_(2021~2024반기).csv)
- **칼럼**: 시도시군구, 구분, 항목, 연도별 반기별 데이터
- **역할**: 추가적인 취업자 데이터 보완
- **총 행 수**: 4,852행

## 3. 전처리 단계별 계획

### 3.1 1단계: 기본 지역 정보 정리
- `지역_면적_utf8.csv`를 기준으로 시도-시군구 매핑 테이블 생성
- 면적 정보 정리

### 3.2 2단계: E9 체류자 데이터 전처리
- 인코딩 문제 해결 (cp949 또는 euc-kr로 읽기)
- 2019~2023년 데이터만 추출
- 시도-시군구 매핑 적용
- 반기 정보 추가 (기본값: 2)

### 3.3 3단계: 산업별 종사자 데이터 전처리
- 제조업(B,C)과 서비스업(E,L~S) 데이터만 추출
- 시도-시군구 매핑 적용
- 연도별 반기별 데이터를 long format으로 변환

### 3.4 4단계: 취업자 및 고용률 데이터 전처리
- 시도-시군구 매핑 적용
- 연도별 반기별 데이터를 long format으로 변환
- 2019~2023년 데이터만 추출

### 3.5 5단계: 데이터 병합
- 모든 데이터를 시도-시군구-연도-반기 기준으로 병합
- 누락된 데이터는 적절한 방법으로 처리

### 3.6 6단계: 최종 데이터 검증
- 데이터 무결성 검사
- 이상치 확인 및 처리
- 최종 데이터셋 생성

## 4. 예상 문제점 및 해결방안

### 4.1 인코딩 문제
- **문제**: E9 체류자 데이터의 깨진 문자
- **해결**: cp949 또는 euc-kr 인코딩으로 읽기

### 4.2 시도-시군구 매핑 불일치
- **문제**: 일부 데이터에 시도 정보 누락
- **해결**: `지역_면적_utf8.csv` 기준으로 시도 정보 추가

### 4.3 반기 정보 누락
- **문제**: 일부 데이터에 반기 구분 없음
- **해결**: 기본값으로 2 반기 설정

### 4.4 데이터 형식 불일치
- **문제**: wide format vs long format
- **해결**: 모든 데이터를 long format으로 통일

## 5. 구현 순서

1. **기본 지역 정보 클래스** 생성
2. **E9 체류자 전처리 클래스** 생성
3. **산업별 종사자 전처리 클래스** 생성
4. **취업자 고용률 전처리 클래스** 생성
5. **데이터 병합 클래스** 생성
6. **메인 전처리 파이프라인** 구현

## 6. 최종 출력 형태

```python
# 예상 최종 데이터 구조
final_data = {
    '시도': ['서울특별시', '서울특별시', ...],
    '시군구': ['종로구', '중구', ...],
    '면적': [23, 9, ...],
    '연도': [2019, 2019, 2019, 2019, 2020, ...],
    '반기': [1, 2, 1, 2, 1, ...],
    'E9_체류자수': [값, 값, ...],
    '제조업_종사자수': [값, 값, ...],
    '서비스업_종사자수': [값, 값, ...],
    '취업자': [값, 값, ...],
    '고용률': [값, 값, ...]
}
```

## 7. 성공 지표

- [ ] 모든 231개 지역에 대해 2019~2023년 데이터 완성
- [ ] 각 지역-연도-반기 조합에 대해 10개 칼럼 모두 완성
- [ ] 데이터 무결성 검사 통과
- [ ] 최종 데이터셋 CSV 파일 생성 완료
